<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>niwi.nz : Framebuffer con UTF-8 en FreeBSD >= 8.x</title>
    <meta name=viewport content='width=200, initial-scale=1'>

  <meta name="desciption" content="Leyendo varias noticias me he encontrado con un articulo que explica (en ruso) como poder tener &#34;framebuffer&#34; con caracteres unicode en la consola de FreeBSD. Esta mejora se ha introducido en la rama 8, por lo que para usarlo tendríamos que tener la actual 8.2 o 9.0. El sistema grafico &#34;framebuffer&#34; fue introducido hace 13 años (version 3.0). Para activarlo compilamos el nucleo con las siguientes opciones: options SC_PIXEL_MODE options VESA Ver los modos de vídeo disponible y..." />
    <meta name="author" content="Andrey Antukh" />

    <link rel="stylesheet" href="https://niwi.nz/theme/css/main.css" />

      <link href="https://niwi.nz/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="niwi.nz Atom Feed" />

      <link href="https://niwi.nz/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="niwi.nz RSS Feed" />

    <!--[if IE]>
        <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!--[if lte IE 7]>
        <link rel="stylesheet" type="text/css" media="all" href="https://niwi.nz/css/ie.css"/>
        <script src="https://niwi.nz/js/IE8.js" type="text/javascript"></script>
    <![endif]-->

    <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" media="all" href="https://niwi.nz/css/ie6.css"/>
    <![endif]-->
  </head>

  <body>
    <div id="wrap">
      <div id="container">

        <div class="entry">
  <header>
    <a href="https://niwi.nz"><small>(return to home)</small></a>
    <h1>
      <a href="https://niwi.nz/2012/03/19/framebuffer-con-utf-8-en-freebsd-8x/" id="page-title">Framebuffer con UTF-8 en FreeBSD >= 8.x</a>
    </h1>
    <div class="article-meta">
        <small class="time">
          Date:
          <time datetime="2012-03-19T00:00:00+00:00">
            Mon 19 March 2012
          </time>
        </small>
      <br />
      <small class="tags">
        Tags:
          <a href="https://niwi.nz/tag/freebsd.html">freebsd,           </a>
          <a href="https://niwi.nz/tag/unicode.html">unicode          </a>
      </small>

      <br />
      <small class="tags">
        Author:
          <span>Andrey Antukh</span>      </small>
    </div>
  </header>
  <article>
    <div id="article-content">
      <p>Leyendo varias noticias me he encontrado con un articulo que explica (en ruso) como poder tener "framebuffer" con caracteres unicode en la consola de FreeBSD.</p>
<p>Esta mejora se ha introducido en la rama 8, por lo que para usarlo tendríamos que tener la actual 8.2 o 9.0.</p>
<p>El sistema grafico "framebuffer" fue introducido hace 13 años (version 3.0). Para activarlo compilamos el nucleo con las siguientes opciones:</p>
<div class="highlight"><pre><span></span><code>options SC_PIXEL_MODE
options VESA
</code></pre></div>

<h3>Ver los modos de vídeo disponible y activamos uno:</h3>
<p>Una vez compilado el kernel y haber reiniciado, inicie sesión con el usuario root y teclee el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>vidcontrol -i mode
</code></pre></div>

<p>Vera una larga lista de modos disponibles, en este ejemplo seleccionamos el de "1024x768" y que en mi caso esta resolución es el modo 280. Para activarlo, ejecutamos el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>vidcontrol MODE_280
</code></pre></div>

<p>Si esto ha funcionado, bien. En caso contrario si ve una pantalla en blanco, quiere decir que su tarjeta de vídeo o el monitor no tiene soporte para este modo. Tendrá que ir a otra terminal y probar otro modo.</p>
<p>Una vez sabemos, que modo es el que nos funciona, lo dejamos por defecto con la siguiente opcion en «/etc/rc.conf»:</p>
<div class="highlight"><pre><span></span><code>allscreens_flags=&quot;MODE_280&quot;
</code></pre></div>

<h3>Soporte UTF-8 en syscons:</h3>
<p>Nota: esto no lo he probado personalmente por lo que no puedo asegurar que funcione tal cual. Los datos los he sacodo del siguiente articulo: <a href="http://dadv.livejournal.com/162099.html">http://dadv.livejournal.com/162099.html</a>. En cuanto confirme, borrare esta nota.</p>
<p>FreeBSD 8.x como las versiones anteriores utilizan «cons25» como tipo de consola por defecto. Para activar utf-8, tenemos que cambiarnos a «xterm». En FreeBSD 9, xterm ya es la opción por defecto.</p>
<p>Añadimos las siguientes opciones a la configuración del kernel:</p>
<div class="highlight"><pre><span></span><code>options         TEKEN_XTERM             # xterm-style terminal emulation (Only on freebsd &lt;= 8.x)
options         TEKEN_UTF8              # UTF-8 output handling
</code></pre></div>

<p>Segun el articulo, para que los cambios funcionen de manera permanente hay que modificar «/boot/device.hints» y añadir 0x80 a los flags de syscons (anteriormente el valor era 0x100):</p>
<div class="highlight"><pre><span></span><code>hint.sc.0.flags=&quot;0x180&quot;
</code></pre></div>

<p>Instalamos «sysutils/jfbterm» de los ports, es el terminal que se encargaría de pintar los caracteres en modo de vídeo. Ademas debemos modificar «/etc/ttys» y cambiar «cons25» por «xterm» en caso de estar en FreeBSD &lt; 9.x.</p>
<p>Seteamos la variable de entorno LANG por ejemplo con "ru_RU.UTF-8" mediante los clases de inicio de sesión (login class) o mediante la configuración de la shell por defecto. Entramos y comprobamos que realmente esta variable esta asignada tal como deseamos y ejecutamos jfbterm, es posible que con este comando nuestro modo de vídeo cambie.</p>
<p>Para comprobar el modo de vide actual existen varias formas:</p>
<div class="highlight"><pre><span></span><code>vidcontrol -i adapter &lt; /dev/ttyv0
vidcontrol -i mode &lt; /dev/ttyv0
</code></pre></div>

<p>Sin jfbterm los caracteres cirilicos no podrían pintarse adecuadamente.</p>
    </div>
  </article>
        </div>
      </div>

    </div>
  </body>
</html>