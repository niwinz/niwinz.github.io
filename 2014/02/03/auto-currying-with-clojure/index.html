<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>niwi.nz : Auto currying with clojure</title>
    <meta name="viewport" content="width=200, initial-scale=1" />
  <meta name="desciption" content="Currying, is one of the much others featues that haskell implements nativelly but is not widelly extended on lisp like languages. But thanks to the power of lisp, it should be possible to extend the language so that is able to support autocurry. This is my simple experiment using clojure macros for implement autocurrying: (defmacro defc [identifier bindings &amp; body] (let [n# (count bindings)] `(def ~identifier (fn [&amp; args#] (if (&lt; (count args#) ~n#) (apply partial ~identifier..." />
    <meta name="author" content="Andrey Antukh" />

    <link rel="stylesheet" href="https://niwi.nz/theme/css/main.css" />

      <link href="https://niwi.nz/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="niwi.nz Atom Feed" />


  </head>

  <body>
    <main>
  <header>
    <a class="back" href="https://niwi.nz"><< back</a>
    <h1>
      <a href="https://niwi.nz/2014/02/03/auto-currying-with-clojure/" id="page-title">Auto currying with clojure</a>
    </h1>
    <div class="article-meta">
        <small class="time">
          Date:
          <time datetime="2014-02-03T00:00:00+00:00">
            Mon 03 February 2014
          </time>
        </small>
      <br />
      <small class="tags">
        Tags:
          <a href="https://niwi.nz/tag/clojure.html">clojure,           </a>
          <a href="https://niwi.nz/tag/lisp.html">lisp          </a>
      </small>

      <br />
      <small class="tags">
        Author:
          <span>Andrey Antukh</span>      </small>
    </div>
  </header>
  <article>
    <div id="article-content">
      <p>Currying, is one of the much others featues that haskell implements nativelly but
is not widelly extended on lisp like languages. But thanks to the power of lisp,
it should be possible to extend the language so that is able to support autocurry.</p>
<p>This is my simple experiment using clojure macros for implement
autocurrying:</p>
<div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defmacro </span><span class="nv">defc</span>
  <span class="p">[</span><span class="nv">identifier</span> <span class="nv">bindings</span> <span class="o">&amp;</span> <span class="nv">body</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">n#</span> <span class="p">(</span><span class="nb">count </span><span class="nv">bindings</span><span class="p">)]</span>
    <span class="o">`</span><span class="p">(</span><span class="k">def </span><span class="o">~</span><span class="nv">identifier</span>
       <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="o">&amp;</span> <span class="nv">args#</span><span class="p">]</span>
         <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="nb">count </span><span class="nv">args#</span><span class="p">)</span> <span class="o">~</span><span class="nv">n#</span><span class="p">)</span>
           <span class="p">(</span><span class="nb">apply partial </span><span class="o">~</span><span class="nv">identifier</span> <span class="nv">args#</span><span class="p">)</span>
           <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">myfn#</span> <span class="p">(</span><span class="k">fn </span><span class="o">~</span><span class="nv">bindings</span> <span class="o">~@</span><span class="nv">body</span><span class="p">)]</span>
             <span class="p">(</span><span class="nb">apply </span><span class="nv">myfn#</span> <span class="nv">args#</span><span class="p">)))))))</span>
</pre></div>
<p>This is a very ugly macro that contains also ugly var names, all is so because it
was an experiment of ten minuts.</p>
<p>Here, a simple example using previously defined macro:</p>
<div class="highlight"><pre><span></span><span class="c1">;; Sample function with three arguments. defc works</span>
<span class="c1">;; like clojure&#39;s defn (but much less complete)</span>
<span class="p">(</span><span class="nf">defc</span> <span class="nv">sum-three-numbers</span>
  <span class="p">[</span><span class="nv">num1</span> <span class="nv">num2</span> <span class="nv">num3</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">+ </span><span class="nv">num1</span> <span class="nv">num2</span> <span class="nv">num3</span><span class="p">))</span>

<span class="c1">;; Normal call, return a sum of three numbers</span>
<span class="p">(</span><span class="nf">sum-three-numbers</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1">;; -&gt; 6</span>

<span class="c1">;; When function is called with less arguments,</span>
<span class="c1">;; it returns a curried function.</span>

<span class="p">(</span><span class="nf">sum-three-numbers</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">;; -&gt; #&lt;core$partial$fn__4190 clojure.core$partial$fn__4190@8a20568&gt;</span>

<span class="p">(</span><span class="nf">sum-three-numbers</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">;; -&gt; #&lt;core$partial$fn__4192 clojure.core$partial$fn__4192@892c746&gt;</span>

<span class="p">((</span><span class="nf">sum-three-numbers</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">;; -&gt; #&lt;core$partial$fn__4192 clojure.core$partial$fn__4192@4be0ae98&gt;</span>

<span class="p">(((</span><span class="nf">sum-three-numbers</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">3</span><span class="p">)</span>
<span class="c1">;; -&gt; 6</span>
</pre></div>

    </div>
  </article>
      </div>
    </main>
  </body>
</html>