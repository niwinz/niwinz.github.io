<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>niwi.nz : Realizar búsquedas ignorando las tildes desde Django con PostgreSQL</title>
    <meta name=viewport content='width=200, initial-scale=1'>

  <meta name="desciption" content="En muchas ocasiones, necesitamos realizar búsquedas por palabras pero sin tener en cuenta las tildes. Y en este caso usando PostgreSQL 9.1, tenemos la extensión unaccent que nos permite dejar sin tildes una palabra o un conjunto de palabras. Otra de las ventajas de utilizar PostgreSQL, es por que nos permite crear indices a expresiones o funciones. Como primer paso creamos el indice en el campo que vamos a usar para las búsquedas e instalamos la extensión: CREATE EXTENSION unaccent; ALTER..." />
    <meta name="author" content="Andrey Antukh" />

    <link rel="stylesheet" href="https://www.niwi.nz/theme/css/main.css" />

      <link href="https://www.niwi.nz/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="niwi.nz Atom Feed" />

      <link href="https://www.niwi.nz/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="niwi.nz RSS Feed" />

    <!--[if IE]>
        <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!--[if lte IE 7]>
        <link rel="stylesheet" type="text/css" media="all" href="https://www.niwi.nz/css/ie.css"/>
        <script src="https://www.niwi.nz/js/IE8.js" type="text/javascript"></script>
    <![endif]-->

    <!--[if lt IE 7]>
        <link rel="stylesheet" type="text/css" media="all" href="https://www.niwi.nz/css/ie6.css"/>
    <![endif]-->
  </head>

  <body>
    <div id="wrap">
      <div id="container">

        <div class="entry">
  <header>
    <a href="https://www.niwi.nz"><small>(return to home)</small></a>
    <h1>
      <a href="https://www.niwi.nz/2011/10/05/realizar-busquedas-ignorando-las-tildes-desde-django-con-postgresql/" id="page-title">Realizar búsquedas ignorando las tildes desde Django con PostgreSQL</a>
    </h1>
    <div class="article-meta">
        <small class="time">
          Date:
          <time datetime="2011-10-05T00:00:00+00:00">
            Wed 05 October 2011
          </time>
        </small>
      <br />
      <small class="tags">
        Tags:
          <a href="https://www.niwi.nz/tag/python.html">python,           </a>
          <a href="https://www.niwi.nz/tag/django.html">django,           </a>
          <a href="https://www.niwi.nz/tag/postgresql.html">postgresql          </a>
      </small>

      <br />
      <small class="tags">
        Author:
          <span>Andrey Antukh</span>      </small>
    </div>
  </header>
  <article>
    <div id="article-content">
      <p>En muchas ocasiones, necesitamos realizar búsquedas por palabras pero sin tener en cuenta las tildes. Y en este caso usando PostgreSQL 9.1, tenemos la extensión <strong>unaccent</strong> que nos permite dejar sin tildes una palabra o un conjunto de palabras.</p>
<p>Otra de las ventajas de utilizar PostgreSQL, es por que nos permite crear indices a expresiones o funciones.</p>
<p>Como primer paso creamos el indice en el campo que vamos a usar para las búsquedas e instalamos la extensión:</p>
<div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">unaccent</span><span class="p">;</span><span class="w"></span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">unaccent</span><span class="p">(</span><span class="nb">text</span><span class="p">)</span><span class="w"> </span><span class="k">IMMUTABLE</span><span class="p">;</span><span class="w"></span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">person_name_idx0</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="k">USING</span><span class="w"> </span><span class="n">btree</span><span class="w"> </span><span class="p">(</span><span class="n">unaccent</span><span class="p">(</span><span class="n">name</span><span class="p">));</span><span class="w"></span>
</code></pre></div>

<p>Una vez tenemos la base de datos preparada para realizar consultas, aqui un ejemplo de como realizar una busqueda ignorando las tildes:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Person</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">extra</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;unaccent(name) = </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">],</span> <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Andrei&quot;</span><span class="p">])</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">Person</span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">]</span>
</code></pre></div>
    </div>
  </article>
        </div>
      </div>

    </div>
  </body>
</html>